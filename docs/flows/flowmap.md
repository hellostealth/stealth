# FlowMap

The `FlowMap` is the file that contains your flow and state declarations. It's stored in `config/flow_map.rb` and will be generated by Stealth when you instantiate your bot.

Here is a `FlowMap` similar to the one that is generated for a new bot:

```ruby
class FlowMap

  include Stealth::Flow

  flow :hello do
    state :say_hello
    state :get_hello_response, fails_to: :say_hello
  end

  flow :goodbye do
    state :say_goodbye
  end

  flow :interrupt do
    state :say_interrupted
  end

  flow :unrecognized_message do
    state :handle_unrecognized_message
  end

  flow :catch_all do
    state :level1
  end

end
```

In this example, we've declared five flows: `hello`, `goodbye`, `interrupt`, `unrecognized_message`, and `catch_all`. These are the default flows that are generated for you when you create a new bot.

Each flow consists of an arbitrary number of states. All of the above flows only have a single state, but the `hello` flow has two. As you build out your bot and add functionality, you'll need to keep the `FlowMap` updated. If you attempt to transition to a flow or state that hasn't yet been declared in the `FlowMap`, you'll encounter a Stealth`::Errors::InvalidStateTransition` exception.

States also support  additional options like the `fails_to` option for the `get_hello_response` state. We'll cover these state options in the [State Option docs](state-options.md) section.
